<div class="layout-topbar">
  <a class="layout-topbar-logo" routerLink="">
    <img src="assets/images/logo.svg" alt="logo" />
  </a>

  <button
    #menubutton
    class="p-link layout-menu-button layout-topbar-button"
    (click)="layoutService.onMenuToggle()"
  >
    <i class="pi pi-bars"></i>
  </button>

  <button
    #topbarmenubutton
    class="p-link layout-topbar-menu-button layout-topbar-button"
    (click)="layoutService.showProfileSidebar()"
  >
    <i class="pi pi-ellipsis-v"></i>
  </button>

  <div
    #topbarmenu
    class="layout-topbar-menu"
    [ngClass]="{
      'layout-topbar-menu-mobile-active':
        layoutService.state.profileSidebarVisible
    }"
  >
    <button
      data-cy="balance-widget"
      class="p-link layout-topbar-button w-max"
      (click)="balance.toggle($event)"
    >
      <i class="pi pi-money-bill"></i>
      <span class="topbar-button-text">Баланс</span>
      <span class="ml-2" *ngIf="balance$ | async as balance">{{
        balance.amount | currency
      }}</span>
    </button>
    <p-overlayPanel #overlayPanel #balance>
      <ng-template pTemplate
        ><app-balance-widget></app-balance-widget
      ></ng-template>
    </p-overlayPanel>

    <button
      class="p-link layout-topbar-button"
      (click)="notifications.toggle($event)"
    >
      <ng-container
        *ngIf="uncheckedNotifications$ | async as notifications; else bell"
      >
        <i class="pi pi-bell" pBadge [value]="notifications.toString()"></i>
      </ng-container>
      <ng-template #bell>
        <i class="pi pi-bell"></i>
      </ng-template>

      <span class="topbar-button-text">Сповіщення</span>
    </button>
    <p-overlayPanel #overlayPanel #notifications>
      <ng-template pTemplate>
        <app-notifications></app-notifications>
      </ng-template>
    </p-overlayPanel>

    <button class="p-link layout-topbar-button" (click)="cart.toggle($event)">
      <i
        *ngIf="
          cartItemsNumber$ | async as cartItemsNumber;
          else shoppingIconWithoutBadge
        "
        class="pi pi-shopping-cart"
        pBadge
        [value]="cartItemsNumber.toString()"
      ></i>
      <ng-template #shoppingIconWithoutBadge>
        <i class="pi pi-shopping-cart"></i>
      </ng-template>
      <span class="topbar-button-text">Кошик</span>
    </button>
    <p-overlayPanel #overlayPanel #cart>
      <ng-template pTemplate><app-cart-widget></app-cart-widget></ng-template>
    </p-overlayPanel>

    <button
      class="p-link layout-topbar-button"
      (click)="account.toggle($event)"
    >
      <i class="pi pi-user"></i>
      <span class="topbar-button-text">Акаунт</span>
    </button>
    <p-overlayPanel #overlayPanel #account>
      <ng-template pTemplate>
        <div class="layout-menu-dropdown">
          <button
            pButton
            pRipple
            type="button"
            label="Акаунт"
            class="p-button-text"
            routerLink="account"
          ></button>
          <button
            pButton
            pRipple
            type="button"
            label="Вийти"
            class="p-button-text"
            (click)="logout()"
          ></button>
        </div>
      </ng-template>
    </p-overlayPanel>
  </div>
</div>
